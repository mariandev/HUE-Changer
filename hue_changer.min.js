var HUE_Changer=function(){function k(f,d,a){f/=255;d/=255;a/=255;var c=Math.max(f,d,a),b=Math.min(f,d,a),g,e=(c+b)/2;if(c==b)g=b=0;else{var h=c-b,b=0.5<e?h/(2-c-b):h/(c+b);switch(c){case f:g=(d-a)/h+(d<a?6:0);break;case d:g=(a-f)/h+2;break;case a:g=(f-d)/h+4}g/=6}return[g,b,e]}function l(f,d,a){if(0==d)a=d=f=a;else{var c=function(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*c:0.5>c?b:c<2/3?a+(b-a)*(2/3-c)*6:a},b=0.5>a?a*(1+d):a+d-a*d,g=2*a-b;a=c(g,b,f+1/3);d=c(g,b,f);f=c(g,b,f-1/3)}return[255*
a,255*d,255*f]}this.change_hue=function(f){var d=f.pixels_map||!1;if(!d)return Error("Please provide a valid `image map`.");var a=d.type,d=d.map,c=f.image,b=Object.prototype.toString.call(c),g=f.image_width;if("[object ImageData]"===b)c=c.data;else if("[object HTMLImageElement]"===b){var e=document.createElement("canvas");e.width=c.width;e.height=c.height;var h=e.getContext("2d");ctx.drawImage(c,0,0);c=ctx.getImageData(0,0,canvas.width,canvas.height).data;delete e;delete h}else if("[object Uint8ClampedArray]"!==
b)return Error("Please provide a valid image");if("[object ImageData]"===Object.prototype.toString.call(d))d=d.data;else if("[object HTMLImageElement]"===Object.prototype.toString.call(d))e=document.createElement("canvas"),e.width=d.width,e.height=d.height,h=e.getContext("2d"),ctx.drawImage(d,0,0),d=ctx.getImageData(0,0,canvas.width,canvas.height).data,delete e,delete h;else if("[object Uint8ClampedArray]"!==b)return Error("Please provide a valid `image map`");if("PIXELS_MAP_BOOL"===a)for(a=0;a<c.length;a+=
4)d[a/4]&&(b=k(c[a],c[a+1],c[a+2]),b[0]=option.hue/360,b=l(b[0],b[1],b[2]),c[a]=b[0],c[a+1]=b[1],c[a+2]=b[2]);else if("PIXELS_MAP_HUE"===a)for(a=0;a<c.length;a+=4)-1!=d[a/4]&&(b=k(c[a],c[a+1],c[a+2]),b[0]=d[a/4]/360,b=l(b[0],b[1],b[2]),c[a]=b[0],c[a+1]=b[1],c[a+2]=b[2]);else if("PIXELS_ARRAY"===a)for(a=0;a<d.length;a++)e=4*(d[a][1]*g+d[a][0]),b=k(c[e],c[e+1],c[e+2]),b[0]=f.hue/360,b=l(b[0],b[1],b[2]),c[e]=b[0],c[e+1]=b[1],c[e+2]=b[2];else if("PIXELS_ARRAY_HUE"===a)for(a=0;a<d.length;a++)e=4*(d[a][1]*
g+d[a][0]),b=k(c[e],c[e+1],c[e+2]),b[0]=d[a][2]/360,b=l(b[0],b[1],b[2]),c[e]=b[0],c[e+1]=b[1],c[e+2]=b[2];else if("IMAGE"===a)for(a=0;a<d.length;a+=4){if(255!=d[a]||255!=d[a+1]||255!=d[a+2])b=k(c[a],c[a+1],c[a+2]),b[0]=f.hue/360,b=l(b[0],b[1],b[2]),c[a]=b[0],c[a+1]=b[1],c[a+2]=b[2]}else if("ALL"===a)for(a=0;a<c.length;a+=4)b=k(c[a],c[a+1],c[a+2]),b[0]=f.hue/360,b=l(b[0],b[1],b[2]),c[a]=b[0],c[a+1]=b[1],c[a+2]=b[2];return c}};